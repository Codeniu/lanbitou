(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{364:function(t,a,s){"use strict";s.r(a);var n=s(42),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"使用dockerfile制作tomcat-jdk镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用dockerfile制作tomcat-jdk镜像"}},[t._v("#")]),t._v(" 使用Dockerfile制作tomcat-jdk镜像")]),t._v(" "),s("h3",{attrs:{id:"_1-下载文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载文件"}},[t._v("#")]),t._v(" 1.下载文件")]),t._v(" "),s("p",[t._v("tomcat ：https://tomcat.apache.org/download-90.cgi")]),t._v(" "),s("p",[t._v("jdk ：http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html")]),t._v(" "),s("h3",{attrs:{id:"_2-dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-dockerfile"}},[t._v("#")]),t._v(" 2.Dockerfile")]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定操作的镜像")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("7\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 jdk 和 tomcat 添加到镜像centos的/usr/local/目录下")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" jdk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8u141"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("linux"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("x64.tar.gz /usr/local/\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("9.0.36.tar.gz /usr/local/\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 覆盖相关文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#COPY server.xml /usr/local/apache-tomcat-8.5.50/conf/")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" JAVA_HOME /usr/local/jdk1.8.0_141\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" CLASSPATH $JAVA_HOME/lib/dt.jar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$JAVA_HOME/lib/tools.jar\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" CATALINA_HOME /usr/local/apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("9.0.36\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" PATH $PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$JAVA_HOME/bin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$CATALINA_HOME/lib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$CATALINA_HOME/bin\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" TZ="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Asia/Shanghai"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" JAVA_OPTS="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\\n    -server \\\n    -Xms3g \\\n    -Xmx3g \\\n    -Xmn512m \\\n    -Xss512K \\\n    -Dfile.encoding=UTF-8 \\\n    -verbose:gc \\\n    -XX:+UseConcMarkSweepGC \\\n    -XX:MaxTenuringThreshold=10 \\\n    -XX:+ExplicitGCInvokesConcurrent \\\n    -XX:GCTimeRatio=19 \\\n    -XX:+UseParNewGC \\\n    -XX:+UseCMSCompactAtFullCollection \\\n    -XX:CMSFullGCsBeforeCompaction=10 \\\n    -XX:+CMSClassUnloadingEnabled \\\n    -XX:+CMSParallelRemarkEnabled \\\n    -XX:CMSInitiatingOccupancyFraction=50 \\\n    -Xnoclassgc \\\n    -XX:SoftRefLRUPolicyMSPerMB=0"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 暴露8080端口")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 8080\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 容器启动时运行tomcat")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CMD")]),t._v(" /usr/local/apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("9.0.36/bin/catalina.sh run\n")])])]),s("h3",{attrs:{id:"_3-build"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-build"}},[t._v("#")]),t._v(" 3.build")]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[t._v("docker build "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("t youngniu/tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("9.0.36"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("v1 .\n")])])]),s("h3",{attrs:{id:"_4-run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-run"}},[t._v("#")]),t._v(" 4.run")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("docker run -idt --name tomcat-isc -p 8100:8080 -v /home/tomcat-isc/webapps:/usr/local/tomcat/webapps -v /home/tomcat-isc/logs:/usr/local/tomcat/logs -v /home/tomcat-isc/conf:/usr/local/tomcat/conf tomcat-9.0.36:v1\n")])])]),s("p",[t._v("说明：")]),t._v(" "),s("p",[t._v("* -d 后台运行")]),t._v(" "),s("p",[t._v('* --name mytomcat 容器名称\n* -v /server/webapps:/usr/local/tomcat/webapps/ 挂载当前项目的运行目录到tomcat下的webapps\n* -e TZ="Asia/Shanghai" 设置时区\n* --privileged=true 设置拥有容器中的真正的root权限\n* -p 8080:8080 映射端口（宿主机port : 容器port）\n* tomcat-8.5.50:v1 镜像的名称')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\ndocker run -idt --name tomcat-isc -p 8100:8080 -v /home/tomcat-isc/webapps:/usr/local/tomcat/webapps -v /home/tomcat-isc/logs:/usr/local/tomcat/logs -v /home/tomcat-isc/conf:/usr/local/tomcat/conf tomcat:v1\n\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);