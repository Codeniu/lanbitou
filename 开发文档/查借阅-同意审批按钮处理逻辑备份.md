### 查借阅



#### 同意审批按钮 材料编码

```js
    // 点击同意审批按钮
    handleApprove() {
      console.log("info", this.info);
      console.log("tagData", this.$refs.empower.tagData);

      let cobofoObjList = []; // 查借阅对象的信息
      let codesJson = this.$refs.empower.tagData; // 材料代码 是一个对象
      let codes = [];

      this.info.cobofoApplyPersonList.forEach(item => {
        if (!codesJson[item.mainInFoId]) {
          codes = [];
        } else {
          codes = codesJson[item.mainInFoId];
        }

        let codeStr = "";
        codes.forEach(code => {
          codeStr += code + ",";
        });
        // 去掉最后的逗号
        codeStr = codeStr.substring(0, codeStr.length - 1);

        let obj = {
          id: item.id,
          materialCodes: codeStr
        };

        cobofoObjList.push(obj);
      });

      console.log("cofoboOnjList-new", cobofoObjList);

      let params = {
        id: this.info.id, //申请id
        applyNo: this.info.applyNo, //申请号
        approverCode: "", // ? 审批人编号 后台自动添加?
        approveDate: "", // ?  审批时间 后台自动添加?
        applyLevel: this.info.applyLevel, //审批等级
        applyType: this.info.applyType, //申请类型
        approveStatus: this.info.approveStatus, //审批状态
        status: this.info.status, //状态
        remark: this.info.remark, //备注
        cobofoApplyPersonList: cobofoObjList, // 每个人允许查看的材料代码
        applyCropId:this.info.applyCropId,//
      };

      this.agree_approve_post(params)
        .then(data => {
          // 添加审批记录成功
          // 刷新申请表，实际上当前审批人，确认过审批后，该条记录就不因该显示出来了
          this.$message.success("success");
          this.goBack();
        })
        .catch(data => {
          this.$message.warning("操作失败");
          this.goBack();
        });
    },
```

