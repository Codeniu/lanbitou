# 一、**JDK安装**

两种方式：

yum install  jdk

-  将jdk文件夹中的rpm文件放到linux系统中某个文件夹下，进入该文件夹，通过rpm命令进行安装


```
rpm -ivh jdk-8u151-linux-x64.rpm

-i  
-v view 
-h 
```

Linux下安装jdk之后默认安装到/usr/java目录下，可以进入该目录下/usr/java/bin 输入 java-version 命令查看是否安装成功

-  配置环境变量


```
vim /etc/profile
```

- 在文件中添加以下内容


```
export=JAVA_HOME=/usr/java/jdk-8u151-linux-x64
:
export CLASSPATH=.:${JAVA_HOME}/lib

export PATH=.:${JAVA_HOME}/bin:$PATH
```

 

- 退出 使用`source /etc/profile` 刷新配置文件使其生效。	


- 在命令行输入`java -version`或者`java` 检测是否配置成功



# 二、**redis安装**

1. 将redis文件夹中的压缩包拷贝到Linux服务器中，进入文件夹下使用tar命令执行解压操作 

   ```
   tar -zxvf redis-3.2.5.tar.gz
   ```

   

2. 进入解压之后的文件目录使用**make**对解压的redis文件进行编译，编译成功之后会在当前文件夹出现src 和redis.conf等文件

3. 进入src文件目录 使用 **make install** 命令进行redis安装。



make && make install

4. 为方便管理，可以将redis.conf文件及src目录下的mkreleasehdr.sh   redis-benchmark  redis-check-aof  redis-check-rdb  redis-cli  redis-server都移动到同一文件夹下。（此步骤也可省略）

5. 设置后台启动redis，

   首先编辑conf文件，将daemonize属性改为yes（表明需要在后台运行），启动redis服务，并指定启动服务配置文件 (此步也可省略，省略之后开启redis服务之后窗口不要关闭)

6. 设置密码

   编辑redis.conf文件, 将其中的requirepass foobared 中的foobared 改为要设置的密码。（此步骤也可省略）

7. 启动redis  进入src 或者第4步移动到的文件夹下 使用命令`redis-server  redis-conf`

进入redis客户端

# 三、nginx安装

将nginx目录下的所有tar文件移动到linux系统上  eg:   /usr/local/nginx目录下，将其全部解压至当前目录

![image-20200424150031264](E:\项目部署软件及流程\项目部署.assets\image-20200424150031264.png)

以上的tar包为nginx的相关依赖，如gcc环境，PCRE依赖库 ，zlib 依赖库 ，OpenSSL安全套接字层密码库（非必须用到https协议需要安装）；

分别进入pcre-8.33 ，zlib，openssl目录下，依次执行命令

```
./configure

make

make install
```

执行完毕之后，此时nginx已经可以正常安装。

但是由于系统中还用到了其他nginx第三方模块，需要引入rtmp模块，将文件夹中的master.zip解压，放在同级目录即可

执行完毕之后，进入解压之后的nginx目录下（以下命令--prefix后的路径自己指定）

```
./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module  --with-pcre=/usr/local/nginx/pcre-8.39 --add-module=/usr/local/nginx/nginx-rtmp-module-master
make
make install
```

***注意：--prefix 为安装目录  --with为编译所需要的模块  --without为不依赖某模块***

进入nginx文件夹下的conf文件夹下，将安装包中的中的nginx.conf替换。在不同的环境注意修改必要配置（ip，端口，转发路径等。在此不再详细说明）

Nginx的启动：进入nginx目录下的sbin目录下，直接执行nginx 即可启动

 

常用命令：进入sbin目录下

```
./nginx -c ./conf/nginx.conf    指定conf文件运行
./nginx  -s reload        重启nginx
./nginx -t                验证nginx配置文件是否正确
./nginx -V                查看nginx版本信息，以及查看依赖的包
```

# 四、mysql安装

创建用户

创建用户和组

```
# groupadd mysql

# useradd -r -g mysql mysql
```

使用-r参数表示mysql用户是一个系统用户，不能登录。

创建安装目录

根据情况而定，以下直接解压在/usr/local目录，无需创建

 

## *1.安装以及初始化*

解压

将mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz包解压到/usr/local目录

`# tar -zxvf mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz -C /usr/local/`

成功后进入/usr/local目录能看见mysql-5.7.28-linux-glibc2.12-x86_64

改名

`\# mv mysql-5.7.22-linux-glibc2.12-x86_64/  mysql`

进入bin目录进行初始化

```
./mysqld --initialize --user=mysql   初始化mysql

./mysql_ssl_rsa_setup       启动SSL 
```

***注：红色标注的是mysql的初始化root用户密码，需要记住，后面要用***

 

## *2.配置及运行*

### 2.1启动mysql

进入mysql目录下的support_files中使用命令 ./mysql.server start(stop)  启动(停止)服务

![img](E:\项目部署软件及流程\项目部署.assets\wps3-1587712691920.jpg) 

### 2.2将mysql服务加入开机启动项

将/usr/local/mysql/support-files/mysql.server 拷贝为/etc/init.d/mysql并设置运行权限，这样就可以使用***\*service mysql\****命令启动/停止服务

```
cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql

chmod +x /etc/init.d/mysql             给文件添加执行权限
```

```
注册为开机服务

chkconfig --add mysql

查看是否注册成功

chkconfig --list mysql
```



### 2.3 启动服务

`\# service mysql start`

 

## 3. 修改mysql密码

### 3.1 连接mysql

\# cd /usr/local/mysql/bin

\# ./mysql -uroot -p

输入上述初始化步骤中得到的root用户初始化密码

### 3.2 修改密码

*mysql> alter user 'root'@'localhost' identified by 'root';*

示例是修改将密码为root

 

### 3.3 远程连接mysql

linux为了安全，默认是不允许mysql服务器以外的机器访问本机mysql数据库服务的，需要重新授权root账号以提供远程访问：

```
mysql> grant all privileges on *.* to root@'%' identified by 'root';

mysql> flush privileges;

查看是否成功：

mysql> select host,user from mysql.user;
```

# 五、tomcat安装

将tomcat文件夹中的tomcat.tar包解压，解压三次，分别命名为tomcat-support,tomcat-isc,tomcat-vue即可，

其中tomcat-support,tomcat-isc,为公共组件，组织权限的服务器。,tomcat-vue为前端服务器

将文件夹中的三个server.xml分别替换相对应的tomcat中的conf下的server.xml。

将web包放在web目录下（为nginx配置的目录）。

coral-isc-server.war和coral-support-server.war分别放在tomcat-isc，tomcat-support中webapps目录下，并依次启动tomcat

启动之后需要进入webapps下，进入编译之后的运行目录下，将相应配置更改

前端：

前端打包，直接放置tomcat-vue中的webapps目录即可

tomcat启动命令：进入bin目录

```
sh start.sh   启动tomcat

sh shutdown.sh    停止tomcat

重启命令：…………………………………………………………………………………………………………………………………………………………没有！ 关闭再开就是重启！         
进入logs文件夹   tail -f catalina.out            查看日志
```

# 六、opencv安装

将opencv中的文件拷贝至/usr/local/opencv下 ，文件目录如下

![img](E:\项目部署软件及流程\项目部署.assets\wps5.jpg) 

然后逐步安装opencv所需的依赖环境

python环境一般linux中会自带有，可以在命令行直接输入python 如果能进入交互式命令界面 ，即为已有python环境，无需在此安装，如果没有，再安装python环境

## 1.安装python

1. 解压  tar -zxvf Python-2.7.8.tgz

2. 改名  mv Python-2.7.8.tgz python

3. 编译： 进入安装目录        	./ configure --prefix=/usr/local/python

4. 执行make指令\**** make   *make实际就是编译源代码，并生成执行文件。*

5. make install 

6. 建立python的软连接     `ln -s /usr/local/python/bin/python /usr/bin/python`

7. 将/usr/local/python/bin加入PATH

8. vim /etc/profile 

   export PATH=$PATH:/usr/local/python3/bin

9. source /etc/profile

可以让profile文件立即生效。



## 2.安装gcc gcc-c++

分别进入 gcc  和  gcc-c++目录,并执行命令

```
rpm -Uvh  *.rpm  --nodeps  --force              批量解压  安装时不检查依赖关系并且强制安装
```

## 3.安装cmake

（安装cmake之前应该系统中已经安装gcc和g++，否则无法编译cmake）

\#回到opencv目录,执行命令:

```
tar -zxvf cmake-3.9.1-Linux-x86_64.tar.gz

./bootstrap && make && make install

cmake --version
```

## 4. 安装 python-devel

\#进入python-decel目录,执行命令:

```
rpm -Uvh  *.rpm  --nodeps  --force
```



## 5. 安装numpy

\#进入numpy目录,执行命令:

```
rpm -Uvh  *.rpm  --nodeps  --force
```



## 6. 安装ffmpeg

\#回到opencv目录,执行命令:

rpm -Uvh  ffmpeg-2.8.15-2.el7.nux.x86_64.rpm --nodeps  --force

 

## 7.解压opencv4.1.1包

unzip opencv-4.1.1.zip

修改ippicv.cmake

进入opencv/3rdparty/ippicv目录,修改ippicv.cmake,将第47行修改为你存放ippicv_2017u3_lnx_intel64_general_20170822.tgz的目录

![img](E:\项目部署软件及流程\项目部署.assets\wps6.jpg) 

例:

![img](E:\项目部署软件及流程\项目部署.assets\wps7.jpg) 

## 8.安装ant依赖（提供java接口）

解压ant的tar包

```
tar -zxvf apache-ant-1.9.14-bin.tar.gz

mv apache-ant-1.9.14-bin.tar.gz ant  改名

修改系统配置文件
vi /etc/profile

export ANT_HOME=/usr/local/ant

export PATH=$ANT_HOME/bin:$PATH

加载配置文件
source /etc/profile

测试ant环境
ant -version
```

## 9.编译安装openCV

进入opencv4.1.1目录

创建build文件夹并进入

依次执行如下命令（make编译的时间比较长，耐心等待即可）

```
cmake -D WITH_TBB=ON -D WITH_EIGEN=ON ..

cmake -D BUILD_DOCS=ON -D BUILD_TESTS=OFF -D BUILD_PERF_TESTS=OFF -D BUILD_EXAMPLES=OFF .. cmake -D WITH_OPENCL=OFF -D WITH_CUDA=OFF -D BUILD_opencv_gpu=OFF -D BUILD_opencv_gpuarithm=OFF -D BUILD_opencv_gpubgsegm=OFF -D BUILD_opencv_gpucodec=OFF -D BUILD_opencv_gpufeatures2d=OFF -D BUILD_opencv_gpufilters=OFF -D BUILD_opencv_gpuimgproc=OFF -D BUILD_opencv_gpulegacy=OFF -D BUILD_opencv_gpuoptflow=OFF -D BUILD_opencv_gpustereo=OFF -D BUILD_opencv_gpuwarping=OFF ..

cmake -D CMAKE_BUILD_TYPE=RELEASE -D CMAKE_INSTALL_PREFIX=/usr/local ..

make  

make install
```

输入opencv_version 查看版本,显示版本号表示安装完成

opencv安装后产生的java必要的依赖文件     

（1）opencv/build/lib/libopencv_java441.so

（2）opencv/build/bin/opencv-441.jar

 

## 10.添加java.library.path

项目运行需要将opencv的java接口 即so静态库 添加到java.library.path中

注意：在不同的linux版本下，配置LIBRARY_PATH的方法可能不同,但是都有两种不同的方式

1.第一种方式：

此方式为添加临时变量

配置LD_LIBRARY_PATH路径

进入/etc/profile  将opencv的build下的lib中的文件加入LD_LIBRARY_PATH

```
export LD_LIBRARY_PATH = /usr/local/opencv/build/lib
```

并使profile生效

2.第二种

进入 /etc/ld.so.conf 

将so静态库所在文件的全路径 添加到其中。保存退出

执行 ldconfig



*附：以上两种方式为在系统中添加库文件的路径。使任何地方都可以调用。类比windows系统中的 **dll** 文件。*

*java中如果需要调用dll 或者调用so库  需要引入 jna.jar 包*



# 七、安装FFMPEG

FFMPEG起的作用为视频的转码，目前主要用在监控设备

安装很简单，解压，将bin目录配置到环境变量即可。



tar.zx包解压命令为：

xz -d xxxxx.tar.xz

tar -xvf xxx.tar





# 八、其他！！！！！！！

## 1.文件权限对应关系

| 权限 | 对应数字 |  意义  |
| :--: | :------: | :----: |
|  r   |    4     |  可读  |
|  w   |    2     |  可写  |
|  x   |    1     | 可执行 |

示例：

![image-20200424160355866](E:\项目部署软件及流程\项目部署.assets\image-20200424160355866.png)

-rwxr-xr-x 1 user1 oinstall   2478 4月  21 2015 configure

​		**rwx**：代表文件所有者(u表示)权限，这里是root，root对该文件拥有读写执行权限。

　　**r-x :**  代5表所属组(g表示)的权限，这里所属组拥有对该文件读和执行的权限。

　　**r-x :**  代表其他人(o表示)的权限，这里和上面权限一样。

表现为数字表示即分别为：755



chmod  +x ....



-rw-r--r--   1 root  root     0 4月  24 19:08 test.sh

644

