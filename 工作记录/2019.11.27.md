### 备份扫面页面初始化画板的函数

```js
 // 初始化画板
    initImgCanvas() {
      vue.nextTick(_ => {
        let customCanvas = this.$refs.table; // canvas显示层
        console.log("有数据吗？", customCanvas);
        this.customcxt = customCanvas.getContext("2d");
        let img = new Image();
        img.src = this.currentImgSrc;
        let that = this;
        img.onload = function() {
          let canvasleft = 0;
          let canvastop = 0;
          let WrH = img.width / img.height; //图片宽高比
          let RWrH = that.DivWidth / that.DivHeight; //放置图片DIV的宽高比
          let aa = 0;
          // 根据宽高比大小判断确定自适应的宽和高
          if (RWrH > WrH) {
            aa = that.DivHeight / img.height;
            that.canvasHeight = that.DivHeight;
            that.canvasWidth = img.width * aa;
            canvasleft = (that.DivWidth - that.canvasWidth) / 2;
            console.log("画布左边距：**" + canvasleft);
          } else {
            aa = that.DivWidth / img.width;
            that.canvasHeight = img.height * aa;
            that.canvasWidth = that.DivWidth;
            canvastop = (that.DivHeight - that.canvasHeight) / 2;
          }
          // that.canvasHeight = img.height;
          // that.canvasWidth = img.width;
          //img浮动定位居中显示
          that.imgstyle =
            " position: relative;  width:" +
            that.canvasWidth +
            " px; height:" +
            that.canvasHeight +
            "px";

          console.log(
            "图片宽度：" + that.canvasWidth + "图片高度：**" + that.canvasHeight
          );
          that.customRwidth = that.canvasWidth / img.width; //原图与展示图片的宽高比
          that.customRheight = that.canvasHeight / img.height;
          //canvas浮动定位
          that.canvasstyle =
            "position: absolute;left: " + 0 + "; top: " + canvastop + ";"; 
          console.log("画布左边距：" + canvasleft + "画布顶部" + canvastop);
        };
      });
    },
    // 初始化高清图画框
    initHdImgCanvas() {
      vue.nextTick(_ => {
        let customCanvas = this.$refs.tableHdmi; // canvas显示层
        console.log("有数据吗？", customCanvas);
        this.customcxtHdmi = customCanvas.getContext("2d");
        let img = new Image();
        img.src = this.currentHdImgSrc;
        let that = this;
        img.onload = function() {
          let canvasleft = 0;
          let canvastop = 0;
          let WrH = img.width / img.height; //图片宽高比
          let RWrH = that.DivWidthHdmi / that.DivHeightHdmi; //放置图片DIV的宽高比
          let aa = 0;
          // 根据宽高比大小判断确定自适应的宽和高
          if (RWrH > WrH) {
            aa = that.DivHeightHdmi / img.height;
            that.canvasHeightHdmi = that.DivHeightHdmi;
            that.canvasWidthHdmi = img.width * aa;
            canvasleft = (that.DivWidthHdmi - that.canvasWidthHdmi) / 2;
            console.log("画布左边距：**" + canvasleft);
          } else {
            aa = that.DivWidth / img.width;
            that.canvasHeightHdmi = img.height * aa;
            that.canvasWidthHdmi = that.DivWidthHdmi;
            canvastop = (that.DivHeightHdmi - that.canvasHeightHdmi) / 2;
          }
          //img浮动定位居中显示
          that.imgstyleHdmi =
            " position: relative;  width:" +
            that.canvasWidthHdmi +
            " px; height:" +
            that.canvasHeightHdmi +
            "px";

          console.log(
            "图片宽度：" +
              that.canvasWidthHdmi +
              "图片高度：**" +
              that.canvasHeightHdmi
          );
          that.customRwidthHdmi = that.canvasWidthHdmi / img.width; //原图与展示图片的宽高比
          that.customRheightHdmi = that.canvasHeightHdmi / img.height;

          that.canvasstyleHdmi =
            "position: absolute;left: " + 0 + "; top: " + canvastop + ";"; //canvas浮动定位
          console.log("画布左边距：" + canvasleft + "画布顶部" + canvastop);
        };
      });
    },
```

![image-20191127084437688](C:\Users\DELL\Desktop\烂笔头\images\image-20191127084437688.png)

![image-20191127084536825](C:\Users\DELL\Desktop\烂笔头\images\image-20191127084536825.png)



图片容器的高度设置为自适应屏幕宽高，整体采用flex布局，图片等比缩放显示。

```css
.item_process{
    height: calc(100vh - 275px);
    position: relative;
    line-height: 80px;
    font-size: 13px;
    overflow: hidden;
}
```

初始化画板的时候，要给canvas一个宽高，这个宽高因该等于img显示时的宽高

```js
// 显示时图片的大小
var obj = document.getElementById("image_div1_img");
var imgShowWidth = obj.width;
var imgShowHeight = obj.height;
// 设置画框的大小
that.canvasWidth = imgShowWidth;
that.canvasHeight = imgShowHeight;
```

**存在问题**：但是当画框初始化完成后，再改变浏览器的宽高这是图片显示的大小变了，但是canvas画框的大小并没有重新初始化。

**解决方案**：监听`imgShowWidth`，`imgShowHeight` 只要改变就重新初始化canvas画框的大小。

